<p id="notice"><%= notice %></p>
<div class="container">

  <div class="row">

    <div class="col-lg-9" style="margin-left:auto; margin-right:auto; width:auto">

      <div id="carouselExampleIndicators" class="carousel slide my-4" data-ride="carousel" style="width: fit-content; margin-left:auto; margin-right:auto">
        <% @premproducts = Product.left_joins(:favorite_products).group(:id).order("COUNT(products.user_id) DESC").uniq.last(3) %>
        <div class="carousel-inner" role="listbox" style="margin-left:auto; margin-right:auto; width:fit-content">
          <div class="carousel-item active">
            <%= image_tag @premproducts.last.photo.url(:medium), class:"d-block " %>
          </div>
          <% @premproducts.last(2).each do |m| %>
          <div class="carousel-item">
            <% if m.photo.present? %>
              <%= image_tag m.photo.url(:medium),class:"d-block " %>
            <% end %>
            <!-- <img class="d-block img-fluid" src="http://placehold.it/900x350" alt="First slide"> -->
          </div>
          <% end %>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>

      <div class="row">
        <% @category = Category.find(params[:id]) %>
        <% @products = Product.where(category_id: @category).left_joins(:favorite_products).group(:id).order("COUNT(products.user_id) DESC").uniq %>
        <% @products.each do |f| %>
        <div class="col-lg-4 col-md-6 mb-4 cd">
          <%= link_to(f) do %>
          <div class="card1">
              <% if f.photo.present? %>
                <%= image_tag f.photo.url(:medium), style:"margin-left:auto; margin-right:auto", class:"card-img-top", alt:"" %>
              <% end %>
            <div class="card-body">
              <h4 class="card-title">
                <%= f.name %>
              </h4>
              <h5 class="card-price">$<%= f.price.round%></h5>
            </div>
          </div>
          <% end %>
        </div>
        <% end %>
      </div>
